---
apiVersion: v1
kind: ConfigMap
metadata:
  name: indian-store-config
  namespace: default
data:
  # Server Configuration
  PORT: "8080"

  # External OAuth URL - this is what users' browsers will be redirected to
  # Must match your actual domain and the path exposed in gateway.yaml
  # We expose Ory at /ory path via HTTPRoute
  ORY_URL: "https://vishalk17.cloudwithme.dev/ory"
  
  # Internal public URL - used for server-to-server token exchange
  # This is the internal Kubernetes service URL for Ory Hydra public API
  # Get with: kubectl get svc -n default | grep ory-hydra-public
  ORY_INTERNAL_URL: "http://ory-hydra-public.default.svc.cluster.local:4444"
  
  # Internal admin URL - used by the MCP server to talk to Hydra admin API
  # This is for server-to-server communication (Dynamic Client Registration, etc.)
  # Get service name with: kubectl get svc -n default | grep ory-hydra-admin
  ORY_ADMIN_URL: "http://ory-hydra-admin.default.svc.cluster.local:4445"
  
  # OAuth callback URL - where Hydra redirects after authentication
  # Must match your domain and be registered with your OAuth client
  ORY_CALLBACK_URL: "https://vishalk17.cloudwithme.dev/oauth/callback"
  
  # Database URL - PostgreSQL connection string for user storage
  # Using the same PostgreSQL instance as Ory Hydra
  DATABASE_URL: "postgres://ory_hydra:ory_password_123@postgres.default.svc.cluster.local:5432/ory_hydra?sslmode=disable"

---
apiVersion: v1
kind: Secret
metadata:
  name: indian-store-secrets
  namespace: default
type: Opaque
stringData:
  # JWT Secret
  # ----------
  # Used by the MCP server to sign its own JWTs (if needed for internal purposes)
  # Generate with: openssl rand -base64 32
  JWT_SECRET: "tGrWWHvaorTIyHcR3RtC43ufCsh41a95CEMAuAbsMqM="

# To update secrets:
#   1. Edit the values above
#   2. Apply: kubectl apply -f configmap.yaml
#   3. Restart: kubectl rollout restart deployment/mcp-service-indian-store
