# Ory Hydra Helm Values
# Deploy with: helm install ory-hydra ory/hydra -f ory-hydra-values.yaml -n default
# Upgrade with: helm upgrade ory-hydra ory/hydra -f ory-hydra-values.yaml -n default

hydra:
  config:
    # PostgreSQL DSN - connection string to database
    # Format: postgres://USERNAME:PASSWORD@HOST:PORT/DATABASE?sslmode=disable
    # Must match credentials in postgres-sts.yaml
    dsn: postgres://ory_hydra:ory_password_123@postgres.default.svc.cluster.local:5432/ory_hydra?sslmode=disable
    
    urls:
      # Public issuer URL - must match your actual domain
      self:
        issuer: https://vishalk17.cloudwithme.dev
      # Consent and login URLs - you need to implement these endpoints
      # These are called by Hydra during OAuth flow
      consent: https://vishalk17.cloudwithme.dev/consent
      login: https://vishalk17.cloudwithme.dev/login
      
    secrets:
      # System secret - encrypts database values
      # Generate with: openssl rand -base64 32
      system:
        - "Lmw46yVWtgXIXIg/wG/kcsFN+uOELglhupiKJ7jejt4="
      # Cookie secret - encrypts cookies
      # Generate with: openssl rand -base64 32
      cookie:
        - "+AzFyZNkPirAaAlXnullOZmNYWSBrJeweIpC0h79opE="
    
    oauth2:
      expose_internal_errors: true
      
    webfinger:
      jwks:
        broadcast_keys:
          - hydra.openid.id-token
      oidc_discovery:
        supported_claims:
          - sub
          - email
          - email_verified
          - name
        supported_scope:
          - openid
          - offline
          - offline_access
          - email
          - profile

  automigration:
    enabled: true

# Service configuration
service:
  public:
    enabled: true
    type: ClusterIP
    port: 4444
    name: ory-hydra-public
  
  admin:
    enabled: true
    type: ClusterIP
    port: 4445
    name: ory-hydra-admin

# Ingress disabled (using Gateway API)
ingress:
  public:
    enabled: false
  admin:
    enabled: false

# Resources
deployment:
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 100m
      memory: 128Mi

# Replica count
replicaCount: 1
